{"version":3,"sources":["../src/__prologue__.js","../src/distributedEvaluation.js","../src/__epilogue__.js"],"names":[],"mappings":"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","file":"capataz-inveniemus.js","sourcesContent":["/** Library capataz-inveniemus wrapper and layout.\n*/\nfunction __init__(base, Sermat, capataz, inveniemus){ \"use strict\";\n\n// Import synonyms. ////////////////////////////////////////////////////////////////////////////////\n\tvar raiseIf = base.raiseIf;\n\n\tSermat.modifiers.mode = Sermat.CIRCULAR_MODE;\n\n// Library layout. /////////////////////////////////////////////////////////////////////////////////\n\tvar exports = {\n\t\t__package__: 'capataz-inveniemus',\n\t\t__name__: 'capataz_inveniemus',\n\t\t__init__: __init__,\n\t\t__dependencies__: [base, Sermat, capataz, inveniemus]\n\t};\n\texports.capataz = capataz;\n\texports.inveniemus = inveniemus;\n\n// See __epilogue__.js\n","/** # Distributed evaluation.\n\nUsually the vast majority of the processing budget of a metaheuristic is dedicated to the evaluation\nof the objective function (e.g. fitness in evolutionary computing). Hence, it makes sence in most\ncases to set up a distributed run so that the clients execute the evaluations of candidate\nsolutions, while the server handles all the rest.\n*/\n\nexports.distributeEvaluation = (function () {\n\t/**\n\t*/\n\tfunction _defaultJobFunction(imports) {\n\t\treturn (''+ function ($imports, element) {\n\t\t\tsermat.include(base);\n\t\t\telement = sermat.mat(element);\n\t\t\treturn element.evaluate();\n\t\t}).replace('$imports', imports.join(', '));\n\t}\n\n\t/** Checks arguments and calculates default values.\n\t*/\n\tfunction _checkArgs(args) {\n\t\targs = Object.assign({\n\t\t\tkeepRunning: false\n\t\t}, args);\n\t\targs.jobPrototype = Object.assign({\n\t\t\timports: ['sermat', 'inveniemus']\n\t\t}, args.jobPrototype);\n\t\targs.jobPrototype.fun = args.jobPrototype.fun ||\n\t\t\t_defaultJobFunction(args.jobPrototype.imports);\n\t\t//TODO raiseIf(args.server instanceof capataz.Capataz, 'Invalid server!');\n\t\t//TODO raiseIf(args.mh instanceof inveniemus.Metaheuristic, 'Invalid metaheuristics!');\n\t\traiseIf(typeof args.jobPrototype !== 'object', 'Invalid `jobPrototype`!');\n\t\traiseIf(!Array.isArray(args.jobPrototype.imports), 'Invalid `jobPrototype.imports`!');\n\t\tvar fun = args.jobPrototype.fun;\n\t\traiseIf(typeof fun !== 'function' && typeof fun !== 'string',\n\t\t\t'Invalid `jobPrototype.fun`!');\n\t\treturn args;\n\t}\n\n\t/** Builds a new `evaluate` method for the problem's `Element` class, which schedules the\n\tjob function in the capataz server.\n\t*/\n\tfunction evaluateFunction(server, imports, fun) {\n\t\treturn function scheduledEvaluate() {\n\t\t\tvar element = this;\n\t\t\treturn server.schedule({\n\t\t\t\tinfo: this.emblem(),\n\t\t\t\tfun: fun,\n\t\t\t\timports: imports,\n\t\t\t\targs: [Sermat.ser(this)]\n\t\t\t}).then(function (evaluation) {\n\t\t\t\telement.evaluation = evaluation;\n\t\t\t\treturn evaluation;\n\t\t\t});\n\t\t};\n\t}\n\n\t/**\n\t*/\n\treturn function distributedEvaluation(args) {\n\t\targs = _checkArgs(args);\n\t\tvar server = args.server,\n\t\t\tmh = args.mh;\n\n\t\t/** Change the element's `evaluate` method to schedule tasks in the Capataz server.\n\t\t*/\n\t\tmh.problem.Element.prototype.evaluate = evaluateFunction(args.server,\n\t\t\targs.jobPrototype.imports, args.jobPrototype.fun);\n\n\t\t/** Log when every step finishes.\n\t\t*/\n\t\tmh.events.on('advanced', function () {\n\t\t\tvar evalStat = mh.statistics.stat({ key:'evaluation', step: mh.step }),\n\t\t\t\tbest = mh.state[0];\n\t\t\tserver.logger.info(\"Advanced to step #\"+ mh.step +\". Evaluations \"+ evalStat.minimum() +\n\t\t\t\t\" < \"+ evalStat.average() +\" < \"+ evalStat.maximum() +\". Best so far: \"+\n\t\t\t\tbest.emblem() +\".\");\n\t\t});\n\n\t\t/** Set the server to stop when the run finishes.\n\t\t*/\n\t\tvar keepRunning = !!args.keepRunning;\n\t\tfunction end() {\n\t\t\tif (!keepRunning) {\n\t\t\t\tserver.logger.info(\"Stopping server.\");\n\t\t\t\tsetTimeout(process.exit, 10);\n\t\t\t}\n\t\t\treturn mh;\n\t\t}\n\t\treturn mh.run().then(function () {\n\t\t\tserver.logger.info(\"Finished.\");\n\t\t\treturn end();\n\t\t}, function (error) {\n\t\t\tserver.logger.error(error +'');\n\t\t\treturn end();\n\t\t});\n\t};\n})(); // distributeEvaluation()\n","// See __prologue__.js\n\n\treturn exports;\n}"]}